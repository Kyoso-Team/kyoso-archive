name: Code Review
on:
  push:
    branches:
      - '**'
  pull_request:
    branches:
      - '**'
jobs:
  review:
    name: Review
    runs-on: ubuntu-latest
    env:
      NODE_ENV: 'development'
      TEST_ENV: 'undefined'
      DATABASE_URL: 'postgresql://example:example@localhost:5432/example'
      TEST_DATABASE_URL: 'postgresql://example:example@localhost:5432/example-test'
      JWT_SECRET: 'secret'
      CRON_SECRET: 'secret'
      OWNER: '1'
      TESTERS: '[1]'
      PUBLIC_CONTACT_EMAIL: 'example@example.com'
      PUBLIC_OSU_CLIENT_ID: '1'
      OSU_CLIENT_SECRET: 'secret'
      PUBLIC_OSU_REDIRECT_URI: 'http://localhost:5173/api/auth/callback/osu'
      PUBLIC_DISCORD_CLIENT_ID: '1'
      DISCORD_CLIENT_SECRET: 'secret'
      PUBLIC_DISCORD_MAIN_REDIRECT_URI: 'http://localhost:5173/api/auth/callback/discord'
      PUBLIC_DISCORD_CHANGE_ACCOUNT_REDIRECT_URI: 'http://localhost:5173/api/auth/callback/discord/change'
      DISCORD_BOT_TOKEN: 'token'
      IPINFO_ACCESS_TOKEN: 'token'
      UPSTASH_REDIS_REST_URL: 'example.upstash.io'
      UPSTASH_REDIS_REST_TOKEN: 'token'
      S3_FORCE_PATH_STYLE: 'true'
      S3_ENDPOINT: 'example.amazonaws.com'
      S3_REGION: 'us-east-1'
      S3_ACCESS_KEY_ID: 'key'
      S3_SECRET_ACCESS_KEY: 'secret'
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Install Bun
        uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest
      - name: Install Dependencies
        run: bun install --frozen-lockfile
      - name: Svelte Check
        run: bun check
      - name: Lint
        run: bun lint
